<script src="https://unpkg.com/htmx.org@1.9.6"></script>

<style>
    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙÙˆØªØ± (Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬ÙˆØ©) */
    .sidebar-footer {
        margin-top: auto; padding-top: 15px; 
        border-top: 1px solid rgba(255,255,255,0.1);
        display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;
    }
    body.collapsed-mode .sidebar-footer { display: flex; flex-direction: column; }

    /* Ø´ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .control-btn {
        background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.05);
        color: #aaa; padding: 10px; border-radius: 12px; font-size: 1rem; 
        cursor: pointer; transition: all 0.2s ease; display: flex; 
        align-items: center; justify-content: center;
    }
    .control-btn:hover { 
        background: var(--accent, #ffb7c5); color: #000; 
        transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .btn-danger-custom:hover { 
        background: var(--neon-red, #ff4d4d) !important; color: #fff !important; 
        border-color: var(--neon-red, #ff4d4d);
    }
</style>

<div class="sidebar" id="sidebar" hx-boost="true" hx-target=".main-content" hx-select=".main-content" hx-swap="outerHTML show:top">
    
    <div class="brand-box">
        <p class="brand-text"><i class="fas fa-satellite-dish"></i> LONA PANEL</p>
        <small style="color: var(--text-muted);">Ultimate Dashboard</small>
        <i class="fas fa-robot fa-2x text-white d-collapsed-block mt-2"></i>
    </div>
    
    <a href="/" class="nav-link"><i class="fas fa-th-large"></i> <span>Ù…Ø±ÙƒØ² Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</span></a>

    <div class="nav-header">Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ§Ù„ØªØ±ÙÙŠÙ‡</div>
    <a href="/game_studio" class="nav-link"><i class="fas fa-palette"></i> <span>Ø§Ø³ØªÙˆØ¯ÙŠÙˆ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</span></a>
    <a href="/games" class="nav-link"><i class="fas fa-gamepad"></i> <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</span></a>
    <a href="/roulette_control" class="nav-link"><i class="fas fa-skull-crossbones"></i> <span>Ø§Ù„Ø±ÙˆÙ„ÙŠØª Ø§Ù„Ù…Ù„ÙƒÙŠ</span></a>
    <a href="/confessions" class="nav-link"><i class="fas fa-envelope-open-text"></i> <span>Ø§Ù„Ø§Ø¹ØªØ±Ø§ÙØ§Øª</span></a>

    <div class="nav-header">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©</div>
    <a href="/moderation" class="nav-link"><i class="fas fa-user-shield"></i> <span>Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ù…Ø´Ø±ÙÙŠÙ†</span></a>
    <a href="/logger_settings" class="nav-link"><i class="fas fa-clipboard-list"></i> <span>Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</span></a>
    <a href="/welcome" class="nav-link"><i class="fas fa-paint-brush"></i> <span>Ø§Ø³ØªÙˆØ¯ÙŠÙˆ Ø§Ù„ØªØ±Ø­ÙŠØ¨</span></a>

    <div class="nav-header">Ø°ÙƒØ§Ø¡ Ø§Ù„Ø¨ÙˆØª</div>
    <a href="/settings" class="nav-link"><i class="fas fa-robot"></i> <span>Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ÙˆØª</span></a>
    <a href="/auto_reply" class="nav-link"><i class="fas fa-brain"></i> <span>Ø§Ù„Ø±Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span></a>
    <a href="/commands" class="nav-link"><i class="fas fa-list-alt"></i> <span>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£ÙˆØ§Ù…Ø±</span></a>

    <div class="nav-header">Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ù†Ø´Ø±</div>
    <a href="/islamic" class="nav-link"><i class="fas fa-mosque"></i> <span>Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ</span></a>
    <a href="/broadcast" class="nav-link"><i class="fas fa-bullhorn"></i> <span>Ø§Ù„Ù…Ø°ÙŠØ¹ Ø§Ù„Ø¢Ù„ÙŠ</span></a>
    <a href="/giveaway" class="nav-link"><i class="fas fa-gift"></i> <span>Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ÙŠÙ Ø§ÙˆÙŠ</span></a>
    <a href="/live_chat" class="nav-link"><i class="fas fa-comments"></i> <span>ØºØ±ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª (Live)</span></a>

    <div class="nav-header">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±</div>
    <a href="#" class="nav-link locked" data-bs-toggle="modal" data-bs-target="#loginModal">
        <i class="fas fa-code"></i> <span>Ø§Ù„Ù…Ø­Ø±Ø± Ø§Ù„Ø´Ø§Ù…Ù„ ğŸ”</span>
    </a>

    <div class="sidebar-footer">
        <form action="/reload" method="post" style="display:contents">
            <button type="submit" class="control-btn" title="ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„ÙØ§Øª"><i class="fas fa-sync"></i></button>
        </form>
        <form action="/change_status" method="post" style="display:contents">
            <button type="submit" class="control-btn" title="ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©"><i class="fas fa-music"></i></button>
        </form>
        <form action="/kill_switch" method="post" style="display:contents" onsubmit="return confirm('âš ï¸ Ù…ØªØ£ÙƒØ¯ ØªØ±ÙŠØ¯ ØªØ³ÙˆÙŠ Ø±ÙŠØ³ØªØ§Ø±Øª Ù„Ù„Ø¨ÙˆØªØŸ');">
            <button type="submit" class="control-btn btn-danger-custom" title="Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…"><i class="fas fa-power-off"></i></button>
        </form>
    </div>
</div>

<script>
    // Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ØªØªÙØ­Øµ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØªØ®Ù„ÙŠ Ø§Ù„Ø²Ø± ÙŠØ¶ÙˆÙŠ
    function updateActiveLink() {
        var currentPath = window.location.pathname;
        var links = document.querySelectorAll('.sidebar .nav-link');
        
        links.forEach(function(link) {
            // 1. Ø·ÙÙŠ Ø§Ù„ÙˆÙ‡Ø¬ Ù…Ù† Ø§Ù„ÙƒÙ„
            link.classList.remove('active');
            
            // 2. Ø´ÙˆÙÙŠ Ø§Ø°Ø§ Ø±Ø§Ø¨Ø· Ù‡Ø°Ø§ Ø§Ù„Ø²Ø± ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            if(link.getAttribute('href') === currentPath) {
                link.classList.add('active');
            }
        });
    }

    // Ø´ØºÙ„ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§ÙˆÙ„ Ù…Ø§ ÙŠÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹
    updateActiveLink();

    // Ø´ØºÙ„ Ø§Ù„Ø¯Ø§Ù„Ø© ÙƒÙ„ Ù…Ø§ HTMX ÙŠØºÙŠØ± Ø§Ù„ØµÙØ­Ø© (Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹)
    document.body.addEventListener('htmx:pushedIntoHistory', function() {
        updateActiveLink();
    });
    
    // Ø­Ù„ Ø§Ø­ØªÙŠØ§Ø·ÙŠ: Ø´ØºÙ„Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
    document.querySelectorAll('.sidebar .nav-link').forEach(l => {
        l.addEventListener('click', function() {
            // Ù†ÙˆØ®Ø± Ø§Ù„ÙˆÙ‡Ø¬ Ù…Ù† Ø§Ù„ÙƒÙ„ ÙÙˆØ±Ø§Ù‹
            document.querySelectorAll('.sidebar .nav-link').forEach(i => i.classList.remove('active'));
            // Ù†Ø¶ÙŠÙÙ‡ Ù„Ù„ÙŠ Ø§Ù†Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡
            this.classList.add('active');
        });
    });
</script>