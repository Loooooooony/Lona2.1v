<!-- Header -->
<div class="d-flex justify-content-between align-items-center mb-5">
    <div class="d-flex align-items-center gap-3">
        <button class="lona-btn-primary d-lg-none" onclick="toggleMobileSidebar()" style="padding: 10px;">
            <i class="fas fa-bars"></i>
        </button>
        <div>
            <h2 class="fw-black m-0 mb-1" style="font-size: 2rem;" data-lang-key="dash_header">Ù…Ø±ÙƒØ² Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ğŸš€</h2>
            <div class="d-flex align-items-center gap-2 text-muted small fw-bold">
                <span class="d-inline-block w-2 h-2 rounded-circle bg-success shadow-lg"></span>
                <span data-lang-key="system_active">Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙŠØ¹Ù…Ù„</span>
            </div>
        </div>
    </div>
</div>

<!-- Stats Grid -->
<div class="row g-4 mb-5">
    <div class="col-6 col-xl-3">
        <div class="lona-card h-100 d-flex flex-column justify-content-between">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="stat-icon" style="color: var(--accent-primary);">
                    <i class="fa-solid fa-users"></i>
                </div>
                <span class="badge bg-light bg-opacity-10 text-white rounded-pill px-3 py-2 fw-normal small" data-lang-key="total_members">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
            </div>
            <div>
                <h2 class="fw-black m-0 mb-1">{{ stats.members }}</h2>
                <span class="text-muted small fw-bold" data-lang-key="members_label">Ø¹Ø¶Ùˆ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±</span>
            </div>
        </div>
    </div>

    <div class="col-6 col-xl-3">
        <div class="lona-card h-100 d-flex flex-column justify-content-between">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="stat-icon text-success">
                    <i class="fa-solid fa-signal"></i>
                </div>
                <span class="badge bg-light bg-opacity-10 text-white rounded-pill px-3 py-2 fw-normal small" data-lang-key="active_now">Ù†Ø´Ø· Ø§Ù„Ø¢Ù†</span>
            </div>
            <div>
                <h2 class="fw-black m-0 mb-1">{{ stats.online }}</h2>
                <span class="text-muted small fw-bold" data-lang-key="online_label">Ù…ØªØµÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹</span>
            </div>
        </div>
    </div>

    <div class="col-6 col-xl-3">
        <div class="lona-card h-100 d-flex flex-column justify-content-between">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="stat-icon" style="color: var(--accent-secondary);">
                    <i class="fa-solid fa-comments"></i>
                </div>
                <span class="badge bg-light bg-opacity-10 text-white rounded-pill px-3 py-2 fw-normal small" data-lang-key="messages_stat">Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</span>
            </div>
            <div>
                <h2 class="fw-black m-0 mb-1">{{ stats.messages_period }}</h2>
                <span class="text-muted small fw-bold" data-lang-key="messages_label">Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø©</span>
            </div>
        </div>
    </div>

    <div class="col-6 col-xl-3">
        <div class="lona-card h-100 d-flex flex-column justify-content-between">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="stat-icon text-warning">
                    <i class="fa-solid fa-layer-group"></i>
                </div>
                <span class="badge bg-light bg-opacity-10 text-white rounded-pill px-3 py-2 fw-normal small" data-lang-key="channels_stat">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</span>
            </div>
            <div>
                <h2 class="fw-black m-0 mb-1">{{ stats.channels }}</h2>
                <span class="text-muted small fw-bold" data-lang-key="channels_label">Ø±ÙˆÙ… ÙˆÙ‚Ù†Ø§Ø©</span>
            </div>
        </div>
    </div>
</div>

<!-- Charts & Rankings -->
<div class="row g-4 mb-5">
    <div class="col-xl-8">
        <div class="lona-card h-100">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h5 class="fw-bold m-0 d-flex align-items-center gap-2">
                    <i class="fa-solid fa-chart-line" style="color: var(--accent-secondary);"></i>
                    <span data-lang-key="chart_title">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ø§Ù…</span>
                </h5>
            </div>
            <div style="height: 350px; width: 100%;">
                <canvas id="mainChart"></canvas>
            </div>
        </div>
    </div>

    <div class="col-xl-4">
        <div class="lona-card h-100">
            <h5 class="fw-bold mb-4 d-flex align-items-center gap-2">
                <i class="fa-solid fa-crown text-warning"></i>
                <span data-lang-key="top_chatters">Ù…Ù„ÙˆÙƒ Ø§Ù„ØªÙØ§Ø¹Ù„ (Top 5)</span>
            </h5>

            <div class="d-flex flex-column gap-3">
                {% for user in top_chatters %}
                <div class="d-flex align-items-center gap-3 p-2 rounded" style="background: rgba(255,255,255,0.02);">
                    <div class="rank-badge" style="background: {{ '#FFD700' if loop.index == 1 else '#C0C0C0' if loop.index == 2 else '#CD7F32' if loop.index == 3 else 'rgba(255,255,255,0.1)' }}; color: {{ '#000' if loop.index <= 3 else '#fff' }};">
                        {{ loop.index }}
                    </div>

                    <img src="{{ user.avatar }}" style="width: 40px; height: 40px; border-radius: 10px;">

                    <div class="flex-grow-1">
                        <div class="fw-bold small">{{ user.name }}</div>
                        <div class="progress mt-1" style="height: 4px; background: rgba(255,255,255,0.1);">
                            <div class="progress-bar" style="width: {{ (user.count / top_chatters[0].count * 100) if top_chatters[0].count > 0 else 0 }}%; background: var(--accent-secondary);"></div>
                        </div>
                    </div>

                    <div class="text-end">
                        <div class="fw-bold small">{{ user.count }}</div>
                    </div>
                </div>
                {% else %}
                <div class="text-center py-5 text-muted opacity-50">
                    <i class="fa-solid fa-ghost fa-2x mb-2"></i>
                    <p class="small" data-lang-key="no_data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©!</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<script>
    // Chart Initialization Script is in layout because it depends on canvas which is here,
    // but the library is loaded in layout.
    // We can leave the script in layout or here.
    // If it's here, it will execute when included.
</script>
